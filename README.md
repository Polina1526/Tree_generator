# Tree_generator

## Описание:
Генератор деревьев, написанный на языке Python, позволяет по заданным начальным данным получить случайное коалесцентное дерево. Генератор позволяет выводить историю миграций и коалесценций в бинарный и в текстовый файлы в спецефическом формате (подробнее см. ниже), а также визуализировать сгенерированные коалесцентные деревья.


## Настройка начальных данных:
Начальные денные читаются из файлов "coefficients" и "migration_rates", находящихся папке со скриптом.

В файле "coefficients" можно настроить следующие параметры:
1) N - эталонный размер популяции
2) k - колличество популяций
3) n - колличество образцов в каждой популяции (следует записать числа в int формате через пробел без прочих разделителей, колличество чисел должно быть равно k)
4) T - время слияния всех популяций (если установить '-1', то слияния популяций не произойдёт)
5) q - частоты коалесценции в каждой популяции (следует записать числа в int формате через пробел без прочих разделителей, колличество чисел должно быть равно k)
6) Q - частота коалесценции в "объединённой" популяции

В файле "migration_rates" необходимо указать матрицу с частотами миграции между популяциями. Размер матрицы должен быть k на k, элементы - положительные числа в формате double. Элементы главной диагонали матрицы должны быть нулевыми.

В файлах "coefficients" и "migration_rates" мржно делать строки с пометками для себя, добавляя в начало этих строк символ '#', таким образом эта строка никак не повлияет на выполнение кода.


## Запуск:
При запуске через консоль генератор принимает следующие дополнительные аргументы:
1) -txt. При установлении -txt=True сгенерированная история коалесценций и миграций будет выведерна в текстовый файл с названием "tree_history" в удобном для чтения формате. Пример: 
 - Migration of 0 from 1 to 0 at 1499 dt; 
    Данная страка говорит о том, что во время t=1799 произошла миграция образца с Id = 0 из популяции №1 в популяцию № 0.
 - Coalescence in 2 population between 1 and 6; at 3534 dt; 
    Данная строка говорит о том, что во время t=3534 в популяции №2 произошла коалесценция между образцами с Id 1 и 6.

2) -ac. При установлении аргумента -ac=n, где n - целое положительное значение будет сгенерированно n различных коалесцентных деревьев с одинаковыми начальными данными и посчитанно средний TMRCA (time to the most recent common ancestor) для этих деревьев. Среднее значение TMRCA выводится в консоль.

3) -d. При становлении -d=True сгенерированное дерево будет визуализироанно, картинка откроется в новом окне.
4) -h. При использовании этого аргумента в консоль быдет выведена подсказка по использованию всех описанных выше аргументов.


## Выход:
Выше был описан интерфейс вывода истории миграции и коалесценции в текстовый файл.

В самом верху бинарного файла записано число типа unsigned int, хранящее TMRCA. Далее каждое событие (миграция или коалесценция) описывается пятью интовыми числами, тип события определяется перым числом в пятёрке: 0 для коалесценции и 1 для миграции.

В случае коалесценции остальные 4 числа обозначают следующее: номер популяции, в которой произошла коалесценция, первый коалесцирующий образец (всегда с меньшим Id), второй коалесцирующий образец (всегда с большим Id), время, в которое коалесценция произошла.

Вслучае миграции остальные 4 числа обозначают следующее: номер популяции, из которой мигрировал образец, номер популяции, в которую мигрировал образец, Id мигрирующего образца, время, в которой миграция произошла.


* Нумерация как образцов, так и популяций ведётся с нуля.
